<div
  tabindex="0"
  (blur)="onTouched()"
  class="multiselect-dropdown"
  (baseCmsJfClickOutside)="closeDropdown()"
>
  <div [class.disabled]="disabled">
    <span
      tabindex="-1"
      class="dropdown-btn"
      (click)="toggleDropdown($event)"
    >
      @if (selectedItems.length == 0) {
        <span>{{ _placeholder }}</span>
      }
      @for (item of selectedItems; track trackByFn(k, item); let k = $index) {
        <span class="selected-item-container">
          <span
            class="selected-item"
            [hidden]="k > this._settings.itemsShowLimit - 1"
            [attr.title]="item.tooltip"
          >
            <span>{{ item.text }}&nbsp;</span>
            <a
              style="padding-left: 2px; color: white"
              (click)="onItemClick($event, item)"
              >x</a
            >
          </span>
        </span>
      }
      <span
        [ngClass]="{'dropdown-multiselect--active': _settings.defaultOpen}"
        style="float: right !important; padding-right: 4px"
      >
        @if (itemShowRemaining() > 0) {
          <span style="padding-right: 15px">+{{ itemShowRemaining() }}</span>
        }
        <span class="dropdown-multiselect__caret"></span>
      </span>
    </span>
  </div>
  <div
    class="dropdown-list"
    [hidden]="!_settings.defaultOpen"
  >
    <ul class="item1">
      @if (
        (_data.length > 0 || _settings.allowRemoteDataSearch) &&
        !_settings.singleSelection &&
        _settings.enableCheckAll &&
        _settings.limitSelection === -1
      ) {
        <li
          (click)="toggleSelectAll()"
          class="multiselect-item-checkbox"
          style="border-bottom: 1px solid #ccc; padding: 10px"
        >
          <input
            type="checkbox"
            aria-label="multiselect-select-all"
            [checked]="isAllItemsSelected()"
            [disabled]="disabled || isLimitSelectionReached()"
          />
          <div>{{ !isAllItemsSelected() ? _settings.selectAllText : _settings.unSelectAllText }}</div>
        </li>
      }
      @if ((_data.length > 0 || _settings.allowRemoteDataSearch) && _settings.allowSearchFilter) {
        <li class="filter-textbox">
          <input
            type="text"
            aria-label="multiselect-search"
            [readOnly]="disabled"
            [placeholder]="_settings.searchPlaceholderText"
            [(ngModel)]="filter.text"
            (ngModelChange)="onFilterTextChange($event)"
          />
        </li>
      }
    </ul>
    <ul
      class="item2"
      [style.maxHeight]="_settings.maxHeight + 'px'"
    >
      @for (item of _data | jfListFilter: filter; track item; let i = $index) {
        <li
          (click)="onItemClick($event, item)"
          class="multiselect-item-checkbox"
          [attr.title]="item.tooltip"
        >
          <input
            type="checkbox"
            [attr.aria-label]="item.text"
            [checked]="isSelected(item)"
            [disabled]="disabled || (isLimitSelectionReached() && !isSelected(item)) || item.isDisabled"
          />
          <div>{{ item.text }}</div>
        </li>
      }
      @if (_data.length != 0 && (_data | jfListFilter: filter).length == 0 && !_settings.allowRemoteDataSearch) {
        <li class="no-filtered-data">
          <h5>{{ _settings.noFilteredDataAvailablePlaceholderText }}</h5>
        </li>
      }
      @if (_data.length == 0 && !_settings.allowRemoteDataSearch) {
        <li class="no-data">
          <h5>{{ _settings.noDataAvailablePlaceholderText }}</h5>
        </li>
      }
    </ul>
  </div>
</div>
